<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>DirectionSearch.as</title>
<link rel="stylesheet" type="text/css" href="../../../../../SourceStyles.css"/>
</head>

<body><pre><span class="ActionScriptpackage">package</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mq</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">finder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">processors</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mapquest</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LatLng</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mapquest</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LatLngCollection</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mapquest</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">services</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">directions</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Directions</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mapquest</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">services</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">directions</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DirectionsEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mapquest</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">services</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">directions</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DirectionsOptions</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mapquest</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">services</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geocode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Geocoder</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mapquest</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">services</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geocode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GeocoderEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mapquest</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">services</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geocode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GeocoderLocation</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mapquest</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">services</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geocode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GeocoderOptions</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mapquest</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">services</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geocode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GeocoderResponse</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mq</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">finder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">controller</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MapManager</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mq</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">finder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MQFinderEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mq</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">finder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">model</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ModelLocator</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mq</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">finder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MQFConstants</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mq</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">finder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">vo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ManeuverVO</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mq</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">finder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">vo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RouteVO</span>;
    
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">EventDispatcher</span>;
    
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">collections</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ArrayCollection</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">mx</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">controls</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Alert</span>;

    <span class="ActionScriptReserved">public</span> <span class="ActionScriptclass">class</span> <span class="ActionScriptDefault_Text">DirectionSearch</span> <span class="ActionScriptReserved">extends</span> <span class="ActionScriptDefault_Text">EventDispatcher</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">directions</span>:<span class="ActionScriptDefault_Text">Directions</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">geoCoder</span>:<span class="ActionScriptDefault_Text">Geocoder</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">locations</span>:<span class="ActionScriptDefault_Text">Array</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">model</span>:<span class="ActionScriptDefault_Text">ModelLocator</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">ModelLocator</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getInstance</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">locationCollection</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">isInitialised</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">DirectionSearch</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">initialise</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">initialise</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>    <span class="ActionScriptBracket/Brace">{</span>
            
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">geoeOption</span>:<span class="ActionScriptDefault_Text">GeocoderOptions</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">GeocoderOptions</span><span class="ActionScriptBracket/Brace">(</span>6<span class="ActionScriptOperator">,</span><span class="ActionScriptReserved">true</span><span class="ActionScriptOperator">,</span><span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span><span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">geoCoder</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Geocoder</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">MQFConstants</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MAP_KEY</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">geoeOption</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">directions</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Directions</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">MQFConstants</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MAP_KEY</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">directions</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">DirectionsEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DIRECTIONS_SUCCESS</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">onDirectionSuccessHandler</span><span class="ActionScriptBracket/Brace">)</span>;
                
            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geoCoder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">GeocoderEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GEOCODE_RESPONSE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">onGeocodeSuccess</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geoCoder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">GeocoderEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GEOCODE_ERROR_EVENT</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">onGeocodeError</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geoCoder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">GeocoderEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">HTTP_ERROR_EVENT</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">onGeocodeHttpError</span><span class="ActionScriptBracket/Brace">)</span>;
            
            
            
            <span class="ActionScriptDefault_Text">MapManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getInstance</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">MQFConstants</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">EVENT_DIRECTION_GEOCODE</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">directionGeocodeHandler</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">MapManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getInstance</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">MQFConstants</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">EVENT_DELETE_DIRECTIONS_TAB</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">removeDirections</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span> 
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">findRoutes</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>    <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dirOption</span>:<span class="ActionScriptDefault_Text">DirectionsOptions</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">DirectionsOptions</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">dirOption</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">narrativeType</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"html"</span>; 
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">locationList</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">locations</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">displayLatLng</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">locations</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">displayLatLng</span><span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">directions</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>    <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">directions</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">DirectionsEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DIRECTIONS_SUCCESS</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">onDirectionSuccessHandler</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">directions</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeRoute</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptDefault_Text">directions</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Directions</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">model</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">map</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">tileMap</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">locationList</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">dirOption</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">directions</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">DirectionsEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DIRECTIONS_SUCCESS</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">onDirectionSuccessHandler</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">directions</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">route</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">onDirectionSuccessHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">DirectionsEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>    <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">manvrList</span>:<span class="ActionScriptDefault_Text">ArrayCollection</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ArrayCollection</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">routeVO</span>:<span class="ActionScriptDefault_Text">RouteVO</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">streetsStr</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">""</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">latlng</span>:<span class="ActionScriptDefault_Text">LatLng</span>
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">type</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">DirectionsEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DIRECTIONS_SUCCESS</span><span class="ActionScriptBracket/Brace">)</span>    <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">routeType</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptString">"route"</span><span class="ActionScriptBracket/Brace">)</span>    <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">location</span>:<span class="ActionScriptDefault_Text">XML</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">locationsXml</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">XML</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">locs</span>:<span class="ActionScriptDefault_Text">XMLList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">location</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">location</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">street</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">city</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">""</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">destOrig</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">for each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">lc</span>:<span class="ActionScriptDefault_Text">XML</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">locs</span><span class="ActionScriptBracket/Brace">)</span>    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">street</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lc</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hasOwnProperty</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"street"</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">lc</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">street</span> : <span class="ActionScriptReserved">null</span>;
                        <span class="ActionScriptDefault_Text">city</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">lc</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hasOwnProperty</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"adminArea5"</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">lc</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">adminArea5</span> : <span class="ActionScriptReserved">null</span>;
                        <span class="ActionScriptDefault_Text">destOrig</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">street</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">", "</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">city</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">route</span>:<span class="ActionScriptDefault_Text">XML</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">legsXml</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">XML</span>;
                    
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">maneuvers</span>:<span class="ActionScriptDefault_Text">XMLList</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">route</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">leg</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">maneuvers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">maneuver</span>;
                    <span class="ActionScriptDefault_Text">model</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">routeLatlngCollection</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">LatLngCollection</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">for each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">manuervs</span>:<span class="ActionScriptDefault_Text">XML</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">maneuvers</span><span class="ActionScriptBracket/Brace">)</span>    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">latlng</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">LatLng</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">manuervs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">startPoint</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lat</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">Number</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">manuervs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">startPoint</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lng</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">streetsStr</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">""</span>
                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">manuervs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">streets</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">street</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">&gt;</span>0<span class="ActionScriptBracket/Brace">)</span>    <span class="ActionScriptBracket/Brace">{</span>
                            <span class="ActionScriptReserved">for each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">strt</span>:<span class="ActionScriptDefault_Text">XML</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">manuervs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">streets</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">street</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                                <span class="ActionScriptDefault_Text">streetsStr</span><span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">strt</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">", "</span>; 
                            <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptBracket/Brace">}</span>
                        <span class="ActionScriptDefault_Text">model</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">routeLatlngCollection</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">add</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">latlng</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">manVO</span>:<span class="ActionScriptDefault_Text">ManeuverVO</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ManeuverVO</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">latlng</span><span class="ActionScriptOperator">,</span>
                            <span class="ActionScriptDefault_Text">manuervs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">distance</span><span class="ActionScriptOperator">,</span>
                            <span class="ActionScriptDefault_Text">manuervs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">time</span><span class="ActionScriptOperator">,</span>
                            <span class="ActionScriptDefault_Text">manuervs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">attributes</span><span class="ActionScriptOperator">,</span>
                            <span class="ActionScriptDefault_Text">manuervs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">turnType</span><span class="ActionScriptOperator">,</span>
                            <span class="ActionScriptDefault_Text">manuervs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">narrative</span><span class="ActionScriptOperator">,</span>
                            <span class="ActionScriptDefault_Text">manuervs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">direction</span><span class="ActionScriptOperator">,</span>
                            <span class="ActionScriptDefault_Text">manuervs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">directionName</span><span class="ActionScriptOperator">,</span>
                            <span class="ActionScriptDefault_Text">manuervs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">index</span><span class="ActionScriptOperator">,</span>
                            <span class="ActionScriptDefault_Text">streetsStr</span><span class="ActionScriptOperator">,</span>
                            <span class="ActionScriptDefault_Text">manuervs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">iconUrl</span><span class="ActionScriptOperator">,</span>
                            <span class="ActionScriptDefault_Text">manuervs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">mapUrl</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">manvrList</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addItem</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">manVO</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptDefault_Text">routeVO</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">RouteVO</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">route</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">leg</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">distance</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">route</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">leg</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">time</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">route</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">leg</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">formattedTime</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">manvrList</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">destOrig</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptComment">//model.routeVO = routeVO;
</span>                    <span class="ActionScriptDefault_Text">MapManager</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getInstance</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">dispatchEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">MQFinderEvent</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">MQFConstants</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">EVENT_SHOW_DIRECTION</span><span class="ActionScriptOperator">,</span><span class="ActionScriptDefault_Text">routeVO</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">onGeocodeSuccess</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">GeocoderEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>    <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">geoCoderResponse</span>:<span class="ActionScriptDefault_Text">GeocoderResponse</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geocoderResponse</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">GeocoderResponse</span>;
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">geoCoderResponse</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">locations</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">==</span> 1<span class="ActionScriptBracket/Brace">)</span>    <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">locations</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">geoCoderResponse</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">locations</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">findRoutes</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span> <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">geoCoderResponse</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">locations</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">&gt;</span> 1<span class="ActionScriptBracket/Brace">)</span>    <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">locationCollection</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addItem</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">geoCoderResponse</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">locations</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">locations</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">geoCoderResponse</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">locations</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">findRoutes</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">Alert</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">show</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"Multi result, dispatch event to show ambiguities!"</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>    <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">Alert</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">show</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"No result"</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">onGeocodeError</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">GeocoderEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>    <span class="ActionScriptBracket/Brace">{</span>
            
        <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">onGeocodeHttpError</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">GeocoderEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>    <span class="ActionScriptBracket/Brace">{</span>
            
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">directionGeocodeHandler</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">MQFinderEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>    <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">locations</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">data</span>;
            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">locationCollection</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ArrayCollection</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geoCoder</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geocode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">locations</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">removeDirections</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">MQFinderEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>    <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">directions</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeRoute</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
    <span class="ActionScriptBracket/Brace">}</span>
<span class="ActionScriptBracket/Brace">}</span></pre></body>
</html>
